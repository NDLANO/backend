/*
 * Part of NDLA article-api.
 * Copyright (C) 2021 NDLA
 *
 * See LICENSE
 */

package db.migration

import no.ndla.articleapi.{TestEnvironment, UnitSuite}
import scala.util.Success

class V31__ConvertBrightcoveIdsTest extends UnitSuite with TestEnvironment {

  test("migration should update data-videoid from ref:xxxx id type to new number format in Brightcove embeds") {

    val learningResourceBefore1 =
      """{"id": 13, "tags": [{"tags": ["statistikk", "metode", "representativt utvalg", "sosial", "spørreundersøkelser"], "language": "nb"}, {"tags": ["statistikk", "metode", "representativt utval"], "language": "nn"}], "notes": [], "title": [{"title": "Spørreundersøkelser", "language": "nb"}, {"title": "Spørjeundersøkingar", "language": "nn"}], "status": {"other": ["IMPORTED"], "current": "PUBLISHED"}, "content": [{"content": "<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utvalg</h2><p>Spørreundersøkelser blir brukt for å få innblikk befolkningens holdninger, oppfatninger og handlinger. Det beste ville selvsagt være å spørre hele befolkningen, men det er så ressurskrevende at det ikke blir gjort. I stedet trekker man et tilfeldig utvalg mennesker som skal representere innbyggerne, og så spør man dem. Det kaller vi et representativt utvalg.</p><p>Når man skal trekke et utvalg fra en populasjon, må alle innenfor det området som skal undersøkes ha like stor sannsynlighet for å bli trukket i utvalget. Dette er et punkt det svært ofte blir syndet mot, særlig når det gjelder såkalte «innringingsprogrammer» i TV eller radio. Ofte opplever vi at publikum blir oppfordret til å ringe inn og gi uttrykk for sin mening i en sak, og så blir det presentert som «det norske folks oppfatning».  Uansett hvor mange som ringer inn, så vil det ikke være korrekt.  For det første er det bare de som ser eller hører på programmet som kan ringe inn. Deretter er det stor sannsynlighet for at de som ringer inn har et stort engasjement i saken, mens de ikke er så engasjert lar være å ringe. Slike utvalg er altså ikke representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er en forutsetning at alle som svarer på spørsmål ikke skal kunne identifiseres. Det er forskningsmessig uetisk å lage spørsmål eller rutiner for behandling av spørreskjemaene som gjør at noen kan identifiseres.</p><p>For å sikre anonymitet er det ikke nok at navn eller andre identifikasjonsmuligheter ikke blir skrevet på svaret. Det skal heller ikke samles inn opplysninger som kan føre til at svareren (respondenten) kan identifiseres. Derfor skal man være varsom med å spørre detaljert om sosial status og geografisk plassering. Dersom noen har svart «prest» på yrke, og det er mulig å finne ut hvor vedkommende bor, så er det brudd på kravet om anonymitet.</p><p>Det er også strenge regler for hva man kan spørre om i en spørreundersøkelse. Man kan for eksempel spørre om en medlem av et kirkesamfunn, men man kan ikke spørre om hvor ofte man ber. Man kan også spørre om en for eller mot narkotika, men ikke om en bruker narkotika. Dersom slike spørsmål skal stilles, skal det innhentes spesiell tillatelse både fra Datatilsynet og fra respondentene.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"ref:93528\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>", "language": "nb"}, {"content": "<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utval</h2><p>Spørjeundersøkingar blir brukte for å få innblikk haldningane, oppfatningane og handlingane til befolkninga. Det beste ville sjølvsagt vore å spørje heile befolkninga, men det er så ressurskrevjande at det ikke blir gjort. I staden trekkjer ein eit tilfeldig utval menneske som skal representere innbyggjarane, og så spør ein dei. Det kallar vi eit representativt utval.</p><p>Når ein skal trekkje eit utval frå ein populasjon, må alle innanfor det området som ein skal undersøkje, ha like stort sannsyn for å bli trekte i utvalet. Dette er eit punkt som det svært ofte blir synda mot, særleg når det gjeld såkalla «innringjarprogram» i tv eller radio. Ofte opplever vi at publikum blir oppfordra til å ringje inn og gi uttrykk for meininga si i ei sak, og så blir denne presentert som «oppfatninga til det norske folk». Men uansett kor mange som ringjer inn, så vil det ikkje vere korrekt.  For det første er det berre dei som ser eller høyrer på programmet, som kan ringje inn. I tillegg er det stort sannsyn for at dei som ringjer inn, har eit stort engasjement i saka, mens dei som ikkje er så engasjerte, lèt vere å ringje inn. Slike utval er altså ikkje representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er ein føresetnad at alle som svarer på spørsmål, ikkje skal kunne identifiserast. Når ein skal forske på noko, er det uetisk å lage spørsmål eller rutinar for handsaming av spørreskjemaa der nokon kan identifiserast.</p><p>For å sikre anonymitet er det ikkje nok at namn eller andre identifikasjonsmoglegheiter ikkje blir skrivne på svaret. Ein skal heller ikkje samle inn opplysningar som kan føre til at svararen (respondenten) kan identifiserast. Derfor skal ein vere varsam med å spørje detaljert om sosial status og geografisk plassering. Dersom nokon har svart «prest» på yrke, og det er mogleg å finne ut kor vedkommande bur, så er det brot på kravet om anonymitet.</p><p>Det er òg strenge reglar for kva ein kan spørje om i ei spørjeundersøking. Ein kan for eksempel spørje om ein er medlem av eit kyrkjesamfunn, men ikkje om kor ofte ein ber. Ein kan òg spørje om ein er for eller imot narkotika, men ikkje om ein bruker narkotika. Dersom ein skal stille slike spørsmål, må ein hente inn spesielt løyve både frå Datatilsynet og frå respondentane.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk.\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"ref:93528\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>", "language": "nn"}], "created": "2013-07-03T18:31:56Z", "updated": "2017-06-23T13:36:48Z", "revision": 1, "copyright": {"license": "CC-BY-SA-4.0", "creators": [{"name": "Leonhard Vårdal", "type": "Writer"}], "processors": [], "rightsholders": []}, "metaImage": [{"altText": "publikasjon", "imageId": "12664", "language": "nb"}, {"altText": "publikasjon", "imageId": "12664", "language": "nn"}], "published": "2017-06-23T13:36:48Z", "updatedBy": "r0gHb9Xg3li4yyXv0QSGQczV3bviakrT", "articleType": "standard", "editorLabels": [], "introduction": [{"language": "nb", "introduction": "Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia. Andre navn på spørreundersøkelser er intervju-undersøkelser, surveyer eller meningsmålinger."}, {"language": "nn", "introduction": "Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia. Andre namn på spørjeundersøking er intervju-undersøking, survey eller meiningsmåling."}], "visualElement": [], "metaDescription": [{"content": "Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia.", "language": "nb"}, {"content": "Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia.", "language": "nn"}], "requiredLibraries": [], "previousVersionsNotes": []}"""
    val learningResourceBefore2 =
      """{"id": 13, "tags": [{"tags": ["statistikk", "metode", "representativt utvalg", "sosial", "spørreundersøkelser"], "language": "nb"}, {"tags": ["statistikk", "metode", "representativt utval"], "language": "nn"}], "notes": [], "title": [{"title": "Spørreundersøkelser", "language": "nb"}, {"title": "Spørjeundersøkingar", "language": "nn"}], "status": {"other": ["IMPORTED"], "current": "PUBLISHED"}, "content": [{"content": "<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utvalg</h2><p>Spørreundersøkelser blir brukt for å få innblikk befolkningens holdninger, oppfatninger og handlinger. Det beste ville selvsagt være å spørre hele befolkningen, men det er så ressurskrevende at det ikke blir gjort. I stedet trekker man et tilfeldig utvalg mennesker som skal representere innbyggerne, og så spør man dem. Det kaller vi et representativt utvalg.</p><p>Når man skal trekke et utvalg fra en populasjon, må alle innenfor det området som skal undersøkes ha like stor sannsynlighet for å bli trukket i utvalget. Dette er et punkt det svært ofte blir syndet mot, særlig når det gjelder såkalte «innringingsprogrammer» i TV eller radio. Ofte opplever vi at publikum blir oppfordret til å ringe inn og gi uttrykk for sin mening i en sak, og så blir det presentert som «det norske folks oppfatning».  Uansett hvor mange som ringer inn, så vil det ikke være korrekt.  For det første er det bare de som ser eller hører på programmet som kan ringe inn. Deretter er det stor sannsynlighet for at de som ringer inn har et stort engasjement i saken, mens de ikke er så engasjert lar være å ringe. Slike utvalg er altså ikke representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er en forutsetning at alle som svarer på spørsmål ikke skal kunne identifiseres. Det er forskningsmessig uetisk å lage spørsmål eller rutiner for behandling av spørreskjemaene som gjør at noen kan identifiseres.</p><p>For å sikre anonymitet er det ikke nok at navn eller andre identifikasjonsmuligheter ikke blir skrevet på svaret. Det skal heller ikke samles inn opplysninger som kan føre til at svareren (respondenten) kan identifiseres. Derfor skal man være varsom med å spørre detaljert om sosial status og geografisk plassering. Dersom noen har svart «prest» på yrke, og det er mulig å finne ut hvor vedkommende bor, så er det brudd på kravet om anonymitet.</p><p>Det er også strenge regler for hva man kan spørre om i en spørreundersøkelse. Man kan for eksempel spørre om en medlem av et kirkesamfunn, men man kan ikke spørre om hvor ofte man ber. Man kan også spørre om en for eller mot narkotika, men ikke om en bruker narkotika. Dersom slike spørsmål skal stilles, skal det innhentes spesiell tillatelse både fra Datatilsynet og fra respondentene.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"ref:125442\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>", "language": "nb"}, {"content": "<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utval</h2><p>Spørjeundersøkingar blir brukte for å få innblikk haldningane, oppfatningane og handlingane til befolkninga. Det beste ville sjølvsagt vore å spørje heile befolkninga, men det er så ressurskrevjande at det ikke blir gjort. I staden trekkjer ein eit tilfeldig utval menneske som skal representere innbyggjarane, og så spør ein dei. Det kallar vi eit representativt utval.</p><p>Når ein skal trekkje eit utval frå ein populasjon, må alle innanfor det området som ein skal undersøkje, ha like stort sannsyn for å bli trekte i utvalet. Dette er eit punkt som det svært ofte blir synda mot, særleg når det gjeld såkalla «innringjarprogram» i tv eller radio. Ofte opplever vi at publikum blir oppfordra til å ringje inn og gi uttrykk for meininga si i ei sak, og så blir denne presentert som «oppfatninga til det norske folk». Men uansett kor mange som ringjer inn, så vil det ikkje vere korrekt.  For det første er det berre dei som ser eller høyrer på programmet, som kan ringje inn. I tillegg er det stort sannsyn for at dei som ringjer inn, har eit stort engasjement i saka, mens dei som ikkje er så engasjerte, lèt vere å ringje inn. Slike utval er altså ikkje representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er ein føresetnad at alle som svarer på spørsmål, ikkje skal kunne identifiserast. Når ein skal forske på noko, er det uetisk å lage spørsmål eller rutinar for handsaming av spørreskjemaa der nokon kan identifiserast.</p><p>For å sikre anonymitet er det ikkje nok at namn eller andre identifikasjonsmoglegheiter ikkje blir skrivne på svaret. Ein skal heller ikkje samle inn opplysningar som kan føre til at svararen (respondenten) kan identifiserast. Derfor skal ein vere varsam med å spørje detaljert om sosial status og geografisk plassering. Dersom nokon har svart «prest» på yrke, og det er mogleg å finne ut kor vedkommande bur, så er det brot på kravet om anonymitet.</p><p>Det er òg strenge reglar for kva ein kan spørje om i ei spørjeundersøking. Ein kan for eksempel spørje om ein er medlem av eit kyrkjesamfunn, men ikkje om kor ofte ein ber. Ein kan òg spørje om ein er for eller imot narkotika, men ikkje om ein bruker narkotika. Dersom ein skal stille slike spørsmål, må ein hente inn spesielt løyve både frå Datatilsynet og frå respondentane.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk.\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"ref:125442\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>", "language": "nn"}], "created": "2013-07-03T18:31:56Z", "updated": "2017-06-23T13:36:48Z", "revision": 1, "copyright": {"license": "CC-BY-SA-4.0", "creators": [{"name": "Leonhard Vårdal", "type": "Writer"}], "processors": [], "rightsholders": []}, "metaImage": [{"altText": "publikasjon", "imageId": "12664", "language": "nb"}, {"altText": "publikasjon", "imageId": "12664", "language": "nn"}], "published": "2017-06-23T13:36:48Z", "updatedBy": "r0gHb9Xg3li4yyXv0QSGQczV3bviakrT", "articleType": "standard", "editorLabels": [], "introduction": [{"language": "nb", "introduction": "Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia. Andre navn på spørreundersøkelser er intervju-undersøkelser, surveyer eller meningsmålinger."}, {"language": "nn", "introduction": "Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia. Andre namn på spørjeundersøking er intervju-undersøking, survey eller meiningsmåling."}], "visualElement": [], "metaDescription": [{"content": "Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia.", "language": "nb"}, {"content": "Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia.", "language": "nn"}], "requiredLibraries": [], "previousVersionsNotes": []}"""

    val learningResourceAfter1 =
      """{"id":13,"tags":[{"tags":["statistikk","metode","representativt utvalg","sosial","spørreundersøkelser"],"language":"nb"},{"tags":["statistikk","metode","representativt utval"],"language":"nn"}],"notes":[],"title":[{"title":"Spørreundersøkelser","language":"nb"},{"title":"Spørjeundersøkingar","language":"nn"}],"status":{"other":["IMPORTED"],"current":"PUBLISHED"},"content":[{"content":"<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utvalg</h2><p>Spørreundersøkelser blir brukt for å få innblikk befolkningens holdninger, oppfatninger og handlinger. Det beste ville selvsagt være å spørre hele befolkningen, men det er så ressurskrevende at det ikke blir gjort. I stedet trekker man et tilfeldig utvalg mennesker som skal representere innbyggerne, og så spør man dem. Det kaller vi et representativt utvalg.</p><p>Når man skal trekke et utvalg fra en populasjon, må alle innenfor det området som skal undersøkes ha like stor sannsynlighet for å bli trukket i utvalget. Dette er et punkt det svært ofte blir syndet mot, særlig når det gjelder såkalte «innringingsprogrammer» i TV eller radio. Ofte opplever vi at publikum blir oppfordret til å ringe inn og gi uttrykk for sin mening i en sak, og så blir det presentert som «det norske folks oppfatning».  Uansett hvor mange som ringer inn, så vil det ikke være korrekt.  For det første er det bare de som ser eller hører på programmet som kan ringe inn. Deretter er det stor sannsynlighet for at de som ringer inn har et stort engasjement i saken, mens de ikke er så engasjert lar være å ringe. Slike utvalg er altså ikke representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er en forutsetning at alle som svarer på spørsmål ikke skal kunne identifiseres. Det er forskningsmessig uetisk å lage spørsmål eller rutiner for behandling av spørreskjemaene som gjør at noen kan identifiseres.</p><p>For å sikre anonymitet er det ikke nok at navn eller andre identifikasjonsmuligheter ikke blir skrevet på svaret. Det skal heller ikke samles inn opplysninger som kan føre til at svareren (respondenten) kan identifiseres. Derfor skal man være varsom med å spørre detaljert om sosial status og geografisk plassering. Dersom noen har svart «prest» på yrke, og det er mulig å finne ut hvor vedkommende bor, så er det brudd på kravet om anonymitet.</p><p>Det er også strenge regler for hva man kan spørre om i en spørreundersøkelse. Man kan for eksempel spørre om en medlem av et kirkesamfunn, men man kan ikke spørre om hvor ofte man ber. Man kan også spørre om en for eller mot narkotika, men ikke om en bruker narkotika. Dersom slike spørsmål skal stilles, skal det innhentes spesiell tillatelse både fra Datatilsynet og fra respondentene.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"5796417200001\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>","language":"nb"},{"content":"<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utval</h2><p>Spørjeundersøkingar blir brukte for å få innblikk haldningane, oppfatningane og handlingane til befolkninga. Det beste ville sjølvsagt vore å spørje heile befolkninga, men det er så ressurskrevjande at det ikke blir gjort. I staden trekkjer ein eit tilfeldig utval menneske som skal representere innbyggjarane, og så spør ein dei. Det kallar vi eit representativt utval.</p><p>Når ein skal trekkje eit utval frå ein populasjon, må alle innanfor det området som ein skal undersøkje, ha like stort sannsyn for å bli trekte i utvalet. Dette er eit punkt som det svært ofte blir synda mot, særleg når det gjeld såkalla «innringjarprogram» i tv eller radio. Ofte opplever vi at publikum blir oppfordra til å ringje inn og gi uttrykk for meininga si i ei sak, og så blir denne presentert som «oppfatninga til det norske folk». Men uansett kor mange som ringjer inn, så vil det ikkje vere korrekt.  For det første er det berre dei som ser eller høyrer på programmet, som kan ringje inn. I tillegg er det stort sannsyn for at dei som ringjer inn, har eit stort engasjement i saka, mens dei som ikkje er så engasjerte, lèt vere å ringje inn. Slike utval er altså ikkje representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er ein føresetnad at alle som svarer på spørsmål, ikkje skal kunne identifiserast. Når ein skal forske på noko, er det uetisk å lage spørsmål eller rutinar for handsaming av spørreskjemaa der nokon kan identifiserast.</p><p>For å sikre anonymitet er det ikkje nok at namn eller andre identifikasjonsmoglegheiter ikkje blir skrivne på svaret. Ein skal heller ikkje samle inn opplysningar som kan føre til at svararen (respondenten) kan identifiserast. Derfor skal ein vere varsam med å spørje detaljert om sosial status og geografisk plassering. Dersom nokon har svart «prest» på yrke, og det er mogleg å finne ut kor vedkommande bur, så er det brot på kravet om anonymitet.</p><p>Det er òg strenge reglar for kva ein kan spørje om i ei spørjeundersøking. Ein kan for eksempel spørje om ein er medlem av eit kyrkjesamfunn, men ikkje om kor ofte ein ber. Ein kan òg spørje om ein er for eller imot narkotika, men ikkje om ein bruker narkotika. Dersom ein skal stille slike spørsmål, må ein hente inn spesielt løyve både frå Datatilsynet og frå respondentane.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk.\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"5796417200001\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>","language":"nn"}],"created":"2013-07-03T18:31:56Z","updated":"2017-06-23T13:36:48Z","revision":1,"copyright":{"license":"CC-BY-SA-4.0","creators":[{"name":"Leonhard Vårdal","type":"Writer"}],"processors":[],"rightsholders":[]},"metaImage":[{"altText":"publikasjon","imageId":"12664","language":"nb"},{"altText":"publikasjon","imageId":"12664","language":"nn"}],"published":"2017-06-23T13:36:48Z","updatedBy":"r0gHb9Xg3li4yyXv0QSGQczV3bviakrT","articleType":"standard","editorLabels":[],"introduction":[{"language":"nb","introduction":"Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia. Andre navn på spørreundersøkelser er intervju-undersøkelser, surveyer eller meningsmålinger."},{"language":"nn","introduction":"Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia. Andre namn på spørjeundersøking er intervju-undersøking, survey eller meiningsmåling."}],"visualElement":[],"metaDescription":[{"content":"Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia.","language":"nb"},{"content":"Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia.","language":"nn"}],"requiredLibraries":[],"previousVersionsNotes":[]}"""
    val learningResourceAfter2 =
      """{"id":13,"tags":[{"tags":["statistikk","metode","representativt utvalg","sosial","spørreundersøkelser"],"language":"nb"},{"tags":["statistikk","metode","representativt utval"],"language":"nn"}],"notes":[],"title":[{"title":"Spørreundersøkelser","language":"nb"},{"title":"Spørjeundersøkingar","language":"nn"}],"status":{"other":["IMPORTED"],"current":"PUBLISHED"},"content":[{"content":"<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utvalg</h2><p>Spørreundersøkelser blir brukt for å få innblikk befolkningens holdninger, oppfatninger og handlinger. Det beste ville selvsagt være å spørre hele befolkningen, men det er så ressurskrevende at det ikke blir gjort. I stedet trekker man et tilfeldig utvalg mennesker som skal representere innbyggerne, og så spør man dem. Det kaller vi et representativt utvalg.</p><p>Når man skal trekke et utvalg fra en populasjon, må alle innenfor det området som skal undersøkes ha like stor sannsynlighet for å bli trukket i utvalget. Dette er et punkt det svært ofte blir syndet mot, særlig når det gjelder såkalte «innringingsprogrammer» i TV eller radio. Ofte opplever vi at publikum blir oppfordret til å ringe inn og gi uttrykk for sin mening i en sak, og så blir det presentert som «det norske folks oppfatning».  Uansett hvor mange som ringer inn, så vil det ikke være korrekt.  For det første er det bare de som ser eller hører på programmet som kan ringe inn. Deretter er det stor sannsynlighet for at de som ringer inn har et stort engasjement i saken, mens de ikke er så engasjert lar være å ringe. Slike utvalg er altså ikke representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er en forutsetning at alle som svarer på spørsmål ikke skal kunne identifiseres. Det er forskningsmessig uetisk å lage spørsmål eller rutiner for behandling av spørreskjemaene som gjør at noen kan identifiseres.</p><p>For å sikre anonymitet er det ikke nok at navn eller andre identifikasjonsmuligheter ikke blir skrevet på svaret. Det skal heller ikke samles inn opplysninger som kan føre til at svareren (respondenten) kan identifiseres. Derfor skal man være varsom med å spørre detaljert om sosial status og geografisk plassering. Dersom noen har svart «prest» på yrke, og det er mulig å finne ut hvor vedkommende bor, så er det brudd på kravet om anonymitet.</p><p>Det er også strenge regler for hva man kan spørre om i en spørreundersøkelse. Man kan for eksempel spørre om en medlem av et kirkesamfunn, men man kan ikke spørre om hvor ofte man ber. Man kan også spørre om en for eller mot narkotika, men ikke om en bruker narkotika. Dersom slike spørsmål skal stilles, skal det innhentes spesiell tillatelse både fra Datatilsynet og fra respondentene.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"5796514409001\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>","language":"nb"},{"content":"<section><embed data-align=\"\" data-alt=\"publikasjon av samfunnsspeilet fra SSB. Foto.\" data-caption=\"\" data-resource=\"image\" data-resource_id=\"12664\" data-size=\"full\"><h2>Representativt utval</h2><p>Spørjeundersøkingar blir brukte for å få innblikk haldningane, oppfatningane og handlingane til befolkninga. Det beste ville sjølvsagt vore å spørje heile befolkninga, men det er så ressurskrevjande at det ikke blir gjort. I staden trekkjer ein eit tilfeldig utval menneske som skal representere innbyggjarane, og så spør ein dei. Det kallar vi eit representativt utval.</p><p>Når ein skal trekkje eit utval frå ein populasjon, må alle innanfor det området som ein skal undersøkje, ha like stort sannsyn for å bli trekte i utvalet. Dette er eit punkt som det svært ofte blir synda mot, særleg når det gjeld såkalla «innringjarprogram» i tv eller radio. Ofte opplever vi at publikum blir oppfordra til å ringje inn og gi uttrykk for meininga si i ei sak, og så blir denne presentert som «oppfatninga til det norske folk». Men uansett kor mange som ringjer inn, så vil det ikkje vere korrekt.  For det første er det berre dei som ser eller høyrer på programmet, som kan ringje inn. I tillegg er det stort sannsyn for at dei som ringjer inn, har eit stort engasjement i saka, mens dei som ikkje er så engasjerte, lèt vere å ringje inn. Slike utval er altså ikkje representative.</p><h2>Anonymitet og utforming av spørsmål</h2><p>Det er ein føresetnad at alle som svarer på spørsmål, ikkje skal kunne identifiserast. Når ein skal forske på noko, er det uetisk å lage spørsmål eller rutinar for handsaming av spørreskjemaa der nokon kan identifiserast.</p><p>For å sikre anonymitet er det ikkje nok at namn eller andre identifikasjonsmoglegheiter ikkje blir skrivne på svaret. Ein skal heller ikkje samle inn opplysningar som kan føre til at svararen (respondenten) kan identifiserast. Derfor skal ein vere varsam med å spørje detaljert om sosial status og geografisk plassering. Dersom nokon har svart «prest» på yrke, og det er mogleg å finne ut kor vedkommande bur, så er det brot på kravet om anonymitet.</p><p>Det er òg strenge reglar for kva ein kan spørje om i ei spørjeundersøking. Ein kan for eksempel spørje om ein er medlem av eit kyrkjesamfunn, men ikkje om kor ofte ein ber. Ein kan òg spørje om ein er for eller imot narkotika, men ikkje om ein bruker narkotika. Dersom ein skal stille slike spørsmål, må ein hente inn spesielt løyve både frå Datatilsynet og frå respondentane.</p><embed data-account=\"4806596774001\" data-caption=\"Bruk og misbruk av statistikk.\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"5796514409001\"></section><section><div data-type=\"related-content\"><embed data-article-id=\"14\" data-resource=\"related-content\"></div></section>","language":"nn"}],"created":"2013-07-03T18:31:56Z","updated":"2017-06-23T13:36:48Z","revision":1,"copyright":{"license":"CC-BY-SA-4.0","creators":[{"name":"Leonhard Vårdal","type":"Writer"}],"processors":[],"rightsholders":[]},"metaImage":[{"altText":"publikasjon","imageId":"12664","language":"nb"},{"altText":"publikasjon","imageId":"12664","language":"nn"}],"published":"2017-06-23T13:36:48Z","updatedBy":"r0gHb9Xg3li4yyXv0QSGQczV3bviakrT","articleType":"standard","editorLabels":[],"introduction":[{"language":"nb","introduction":"Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia. Andre navn på spørreundersøkelser er intervju-undersøkelser, surveyer eller meningsmålinger."},{"language":"nn","introduction":"Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia. Andre namn på spørjeundersøking er intervju-undersøking, survey eller meiningsmåling."}],"visualElement":[],"metaDescription":[{"content":"Spørreundersøkelser den mest brukte metoden for å samle inn data om individer i samfunnsvitenskapene, og vi møter daglig eksempler på slike undersøkelser i massemedia.","language":"nb"},{"content":"Spørjeunderøking er den mest brukte metoden for å samle inn data om individ i samfunnsvitskapane, og vi møter dagleg eksempel på slike undersøkingar i massemedia.","language":"nn"}],"requiredLibraries":[],"previousVersionsNotes":[]}"""

    val topicArticleBefore1 =
      """{"id":932,"tags":[{"tags":["handlemønstre","kommunikasjonsprosessen","kundebehov","markedsføre","markedsplan","markedsføring","medievaner","verdikjede"],"language":"nb"},{"tags":["handlemønster","kommunikasjonsprosessen","marknadsføre","marknadsplan","marknadsføring","medievanar","verdikjede"],"language":"nn"}],"notes":[{"note":"Embed plassert før første tekst har blitt slettet og gjort om til visuelt element, dersom det var mulig. Status har blitt endret til 'Til kvalitetssikring'.","user":"System","status":{"other":["IMPORTED"],"current":"PUBLISHED"},"timestamp":"2019-03-29T13:17:08Z"}],"title":[{"title":"Markedsføring og kommunikasjon","language":"nb"},{"title":"Marknadsføring og kommunikasjon","language":"nn"}],"status":{"other":["IMPORTED"],"current":"AWAITING_QUALITY_ASSURANCE"},"content":[{"content":"<section><h2>Hva er markedsføring?</h2><p>Markedsføring som begrep defineres slik i <em>Store norske leksikon</em>:</p><blockquote>Markedsføring dreier seg ikke bare om «kunsten å selge varer, tjenester og ideer», men også om «kunsten å investere i fornøyde kunder».</blockquote><p>Vi kan derfor si at markedsføring handler om:</p><ul><li>å velge ut de produktene kundene ønsker og trenger</li> <li>å bestemme deg for hvilke kunder du vil satse på (målgruppe)</li> <li>å finne ut hvordan produktet skal selges (i butikk, på Internett, fra dør til dør og så videre)</li> <li>å finne ut hvordan du kan yte best mulig kundeservice</li></ul><p>Innenfor emnet markedsføring vil du lære mer om markedsplanen, handlemønster og medievaner, verdikjeden, kommunikasjonsprosessen og ikke minst få tips til utforming av skriftlig informasjon og materiell.</p></section><section><div data-type=\"related-content\"><embed data-article-id=\"933\" data-resource=\"related-content\"></div></section>","language":"nb"},{"content":"<section><h2>Kva er marknadsføring?</h2><p>Marknadsføring som omgrep blir definert slik i <em>Store norske leksikon</em>:</p><blockquote>Markedsføring dreier seg ikke bare om «kunsten å selge varer, tjenester og ideer», men også om «kunsten å investere i fornøyde kunder».</blockquote><p>Vi kan derfor seie at marknadsføring handlar om:</p><ul><li>å velje ut dei produkta kundane ønskjer og treng</li> <li>å bestemme deg for kva slags kundar du vil satse på</li> <li>å finne ut korleis produktet skal seljast (i butikk, på Internett, frå dør til dør og så bortetter)</li> <li>å finne ut korleis du kan yte best mogleg kundeservice</li></ul><p>Innanfor emnet marknadsføring vil du lære meir om marknadsplanen, handlemønster og medievanar, verdikjeda, kommunikasjonsprosessen og ikkje minst få tips til utforming av skriftleg informasjon og materiell.</p></section><section><div data-type=\"related-content\"><embed data-article-id=\"933\" data-resource=\"related-content\"></div></section>","language":"nn"}],"created":"2011-10-24T06:47:03Z","updated":"2018-03-21T09:19:21Z","revision":1,"copyright":{"license":"CC-BY-SA-4.0","creators":[{"name":"Oddvar Torgersen","type":"Writer"},{"name":"Hanne-Lisbet Løite","type":"Writer"}],"processors":[],"rightsholders":[{"name":"Amendor AS","type":"Supplier"},{"name":"NKI Forlaget","type":"Publisher"}]},"metaImage":[{"altText":"Salg i utstillingsvindu. Foto.","imageId":"3258","language":"nb"},{"altText":"Salg i utstillingsvindu. Foto.","imageId":"3258","language":"nn"}],"published":"2018-03-21T09:19:21Z","updatedBy":"r0gHb9Xg3li4yyXv0QSGQczV3bviakrT","articleType":"topic-article","editorLabels":[],"introduction":[{"language":"nb","introduction":"Mange forbinder markedsføring med salg og reklame, men markedsføring handler også om å forstå kundens behov og tilpasse seg en bestemt kundegruppe."},{"language":"nn","introduction":"Mange knyter marknadsføring til sal og reklame, men marknadsføring handlar også om å forstå kunden sine behov og tilpasse seg ei bestemt kundegruppe."}],"visualElement":[{"language":"nb","resource":"<embed data-account=\"4806596774001\" data-caption=\"Markedsføring på fem minutt\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"ref:100471\">"},{"language":"nn","resource":"<embed data-account=\"4806596774001\" data-caption=\"Marknadsføring på fem minutt\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"ref:100505\">"}],"metaDescription":[{"content":"Hva er markedsføring? Markedsføring er alle de fasene i et arbeid som går ut på å tilfredsstille kundens behov slik at vi tjener penger på det.","language":"nb"},{"content":"Kva er marknadsføring? Marknadsføring er alle dei fasane i eit arbeid som går ut på å tilfredsstille kundebehova slik at vi tener pengar på det.","language":"nn"}],"requiredLibraries":[],"previousVersionsNotes":[]}"""
    val topicArticleAfter1 =
      """{"id":932,"tags":[{"tags":["handlemønstre","kommunikasjonsprosessen","kundebehov","markedsføre","markedsplan","markedsføring","medievaner","verdikjede"],"language":"nb"},{"tags":["handlemønster","kommunikasjonsprosessen","marknadsføre","marknadsplan","marknadsføring","medievanar","verdikjede"],"language":"nn"}],"notes":[{"note":"Embed plassert før første tekst har blitt slettet og gjort om til visuelt element, dersom det var mulig. Status har blitt endret til 'Til kvalitetssikring'.","user":"System","status":{"other":["IMPORTED"],"current":"PUBLISHED"},"timestamp":"2019-03-29T13:17:08Z"}],"title":[{"title":"Markedsføring og kommunikasjon","language":"nb"},{"title":"Marknadsføring og kommunikasjon","language":"nn"}],"status":{"other":["IMPORTED"],"current":"AWAITING_QUALITY_ASSURANCE"},"content":[{"content":"<section><h2>Hva er markedsføring?</h2><p>Markedsføring som begrep defineres slik i <em>Store norske leksikon</em>:</p><blockquote>Markedsføring dreier seg ikke bare om «kunsten å selge varer, tjenester og ideer», men også om «kunsten å investere i fornøyde kunder».</blockquote><p>Vi kan derfor si at markedsføring handler om:</p><ul><li>å velge ut de produktene kundene ønsker og trenger</li> <li>å bestemme deg for hvilke kunder du vil satse på (målgruppe)</li> <li>å finne ut hvordan produktet skal selges (i butikk, på Internett, fra dør til dør og så videre)</li> <li>å finne ut hvordan du kan yte best mulig kundeservice</li></ul><p>Innenfor emnet markedsføring vil du lære mer om markedsplanen, handlemønster og medievaner, verdikjeden, kommunikasjonsprosessen og ikke minst få tips til utforming av skriftlig informasjon og materiell.</p></section><section><div data-type=\"related-content\"><embed data-article-id=\"933\" data-resource=\"related-content\"></div></section>","language":"nb"},{"content":"<section><h2>Kva er marknadsføring?</h2><p>Marknadsføring som omgrep blir definert slik i <em>Store norske leksikon</em>:</p><blockquote>Markedsføring dreier seg ikke bare om «kunsten å selge varer, tjenester og ideer», men også om «kunsten å investere i fornøyde kunder».</blockquote><p>Vi kan derfor seie at marknadsføring handlar om:</p><ul><li>å velje ut dei produkta kundane ønskjer og treng</li> <li>å bestemme deg for kva slags kundar du vil satse på</li> <li>å finne ut korleis produktet skal seljast (i butikk, på Internett, frå dør til dør og så bortetter)</li> <li>å finne ut korleis du kan yte best mogleg kundeservice</li></ul><p>Innanfor emnet marknadsføring vil du lære meir om marknadsplanen, handlemønster og medievanar, verdikjeda, kommunikasjonsprosessen og ikkje minst få tips til utforming av skriftleg informasjon og materiell.</p></section><section><div data-type=\"related-content\"><embed data-article-id=\"933\" data-resource=\"related-content\"></div></section>","language":"nn"}],"created":"2011-10-24T06:47:03Z","updated":"2018-03-21T09:19:21Z","revision":1,"copyright":{"license":"CC-BY-SA-4.0","creators":[{"name":"Oddvar Torgersen","type":"Writer"},{"name":"Hanne-Lisbet Løite","type":"Writer"}],"processors":[],"rightsholders":[{"name":"Amendor AS","type":"Supplier"},{"name":"NKI Forlaget","type":"Publisher"}]},"metaImage":[{"altText":"Salg i utstillingsvindu. Foto.","imageId":"3258","language":"nb"},{"altText":"Salg i utstillingsvindu. Foto.","imageId":"3258","language":"nn"}],"published":"2018-03-21T09:19:21Z","updatedBy":"r0gHb9Xg3li4yyXv0QSGQczV3bviakrT","articleType":"topic-article","editorLabels":[],"introduction":[{"language":"nb","introduction":"Mange forbinder markedsføring med salg og reklame, men markedsføring handler også om å forstå kundens behov og tilpasse seg en bestemt kundegruppe."},{"language":"nn","introduction":"Mange knyter marknadsføring til sal og reklame, men marknadsføring handlar også om å forstå kunden sine behov og tilpasse seg ei bestemt kundegruppe."}],"visualElement":[{"language":"nb","resource":"<embed data-account=\"4806596774001\" data-caption=\"Markedsføring på fem minutt\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"5796444576001\">"},{"language":"nn","resource":"<embed data-account=\"4806596774001\" data-caption=\"Marknadsføring på fem minutt\" data-player=\"BkLm8fT\" data-resource=\"brightcove\" data-videoid=\"5796440234001\">"}],"metaDescription":[{"content":"Hva er markedsføring? Markedsføring er alle de fasene i et arbeid som går ut på å tilfredsstille kundens behov slik at vi tjener penger på det.","language":"nb"},{"content":"Kva er marknadsføring? Marknadsføring er alle dei fasane i eit arbeid som går ut på å tilfredsstille kundebehova slik at vi tener pengar på det.","language":"nn"}],"requiredLibraries":[],"previousVersionsNotes":[]}"""

    val migration = spy(new V31__ConvertBrightcoveIds, lenient = true)
    val BcMock = mock[BrightcoveApiClient]

    when(migration.Brightcove).thenReturn(BcMock)
    when(BcMock.fetchBrightcoveVideo("ref:93528")).thenReturn(Success(BrightcoveData("5796417200001")))
    when(BcMock.fetchBrightcoveVideo("ref:125442")).thenReturn(Success(BrightcoveData("5796514409001")))
    when(BcMock.fetchBrightcoveVideo("ref:100471")).thenReturn(Success(BrightcoveData("5796444576001")))
    when(BcMock.fetchBrightcoveVideo("ref:100505")).thenReturn(Success(BrightcoveData("5796440234001")))

    migration.convertArticleUpdate(learningResourceBefore1, 0)._1 should be(learningResourceAfter1)
    migration.convertArticleUpdate(learningResourceBefore2, 0)._1 should be(learningResourceAfter2)

    migration.convertArticleUpdate(topicArticleBefore1, 0)._1 should be(topicArticleAfter1)

  }
}
